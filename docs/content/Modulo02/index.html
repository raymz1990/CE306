<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CE306 - Instrumentação Matemática para Estatística - 2&nbsp; Álgebra Matricial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../content/Modulo03/index.html" rel="next">
<link href="../../content/Modulo01/index.html" rel="prev">
<link href="../../default_overview_image.jpg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../custom.css">
<meta property="og:title" content="CE306 - Instrumentação Matemática para Estatística - 2&nbsp; Álgebra Matricial">
<meta property="og:description" content="Material da disciplina CE306 - Instrumentação Matemática para Estatística do curso de Estatística da Universidade Federal do Paraná (UFPR).">
<meta property="og:image" content="default_overview_image.jpg">
<meta property="og:site_name" content="CE306 - Instrumentação Matemática para Estatística">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../content/Modulo02/index.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Álgebra Matricial</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">CE306 - Instrumentação Matemática para Estatística</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://raymz1990.github.io/CE313/tree/main/book/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-git"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="../../CE306---Instrumentação-Matemática-para-Estatística.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="../../CE306---Instrumentação-Matemática-para-Estatística.docx">
              <i class="bi bi-bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apresentação</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Modulo01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Cálculo Diferencial e Integral</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Modulo02/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Álgebra Matricial</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Modulo03/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Estatística Não Paramétrica 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Modulo04/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Função de Distribuição Empírica</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Exercicios</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Modulo01/Exercicios/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Cálculo Diferencial e Integral para Cientista de Dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Modulo02/Exercicios/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Algebra Matricial</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#vetores-e-escalares" id="toc-vetores-e-escalares" class="nav-link active" data-scroll-target="#vetores-e-escalares"><span class="header-section-number">2.1</span> Vetores e escalares</a>
  <ul class="collapse">
  <li><a href="#operações-com-vetores" id="toc-operações-com-vetores" class="nav-link" data-scroll-target="#operações-com-vetores"><span class="header-section-number">2.1.1</span> Operações com vetores</a></li>
  </ul></li>
  <li><a href="#matrizes" id="toc-matrizes" class="nav-link" data-scroll-target="#matrizes"><span class="header-section-number">2.2</span> Matrizes</a>
  <ul class="collapse">
  <li><a href="#operações-com-matrizes" id="toc-operações-com-matrizes" class="nav-link" data-scroll-target="#operações-com-matrizes"><span class="header-section-number">2.2.1</span> Operações com matrizes</a></li>
  <li><a href="#matrizes-de-formas-especiais" id="toc-matrizes-de-formas-especiais" class="nav-link" data-scroll-target="#matrizes-de-formas-especiais"><span class="header-section-number">2.2.2</span> Matrizes de formas especiais</a></li>
  <li><a href="#rank-e-inversa-de-uma-matriz" id="toc-rank-e-inversa-de-uma-matriz" class="nav-link" data-scroll-target="#rank-e-inversa-de-uma-matriz"><span class="header-section-number">2.2.3</span> <em>Rank </em> e inversa de uma matriz</a></li>
  <li><a href="#matrizes-positivas-definidas" id="toc-matrizes-positivas-definidas" class="nav-link" data-scroll-target="#matrizes-positivas-definidas"><span class="header-section-number">2.2.4</span> Matrizes positivas definidas</a></li>
  <li><a href="#determinante-e-traço-de-uma-matriz" id="toc-determinante-e-traço-de-uma-matriz" class="nav-link" data-scroll-target="#determinante-e-traço-de-uma-matriz"><span class="header-section-number">2.2.5</span> Determinante e traço de uma matriz</a></li>
  <li><a href="#cálculo-vetorial-e-matricial" id="toc-cálculo-vetorial-e-matricial" class="nav-link" data-scroll-target="#cálculo-vetorial-e-matricial"><span class="header-section-number">2.2.6</span> Cálculo vetorial e matricial</a></li>
  <li><a href="#regressão-linear-múltipla" id="toc-regressão-linear-múltipla" class="nav-link" data-scroll-target="#regressão-linear-múltipla"><span class="header-section-number">2.2.7</span> Regressão linear múltipla</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://raymz1990.github.io/CE313/edit/main/book/content/Modulo02/index.qmd" class="toc-action"><i class="bi bi-git"></i>Edit this page</a></li><li><a href="https://raymz1990.github.io/CE313/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Álgebra Matricial</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>A técnica escolhida para ilustrar os conceitos de funções e derivadas em ciência de dados foi o modelo de regressão linear simples. Nós vimos na Seção 1.2.9 que neste modelo o treinamento, ou estimação dos parâmetros, se resumiu a encontrar a solução de um sistema de duas equações lineares. Agora imagine uma situação prática com milhares de potenciais variáveis explicativas: como seria o treinamento deste modelo? Assim, fica claro que precisamos de ferramentas que nos permitam lidar com muitas equações simultâneas e de preferência de uma forma compacta e eficiente. É neste contexto que as ferramentas de Álgebra Matricial são valiosas em ciência de dados.</p>
<p>O objetivo deste Capítulo é apresentar as principais ferramentas de <strong>Álgebra Matricial</strong> úteis em ciência de dados. Como exemplo ilustrativo será apresentado o modelo de regressão linear múltipla que estende o modelo de regressão linear simples permitindo um número arbitrário de variáveis explicativas. Para a sua representação utilizaremos uma notação matricial em que o modelo é escrito matematicamente de uma forma compacta e de fácil entendimento. Além disso, as ferramentas de Álgebra Matricial vão permitir obter equações compactas para os estimadores dos coeficientes de regressão, o que facilita o processo de treinamento do modelo.</p>
<p>Por fim, nós vamos discutir algumas decomposições matriciais que consistem em escrever a matriz gerada pelos dados em formas convenientes para o processo de treinamento e discutir como utilizar tais decomposições em ciência de dados. Especial ênfase será dada ao caso de problemas em que o número de variáveis explicativas é maior que o número de observações ( <em>High Dimensional data </em>). Nestas situações a decomposição em valores singulares leva ao modelo de regressão <em>ridge </em>, também bastante popular em ciência de dados e uma extensão natural do modelo de regressão linear múltipla.</p>
<section id="vetores-e-escalares" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="vetores-e-escalares"><span class="header-section-number">2.1</span> Vetores e escalares</h2>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Definição 2.1</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Um vetor é uma lista de <span class="math inline">\(n\)</span> números (elementos ou componentes) escritos em linha ou coluna.</p>
</div>
</div>
<p>Em termos de notação nós vamos usar letras minúsculas em negrito, por exemplo,</p>
<p><span class="math display">\[
\mathbf{a} = \begin{pmatrix}
a_1 &amp; \ldots &amp; a_n
\end{pmatrix} \quad \text{ou} \quad \mathbf{a} = \begin{pmatrix}
a_1 \\
\vdots \\
a_n
\end{pmatrix}.
\]</span></p>
<p>Quando os elementos estão organizados em linha dizemos que temos um <strong>vetor linha</strong>. Por outro lado, quando os elementos estão organizados em coluna dizemos que temos um <strong>vetor coluna</strong>. Um elemento do vetor é chamado de <span class="math inline">\(a_i\)</span>, sendo <span class="math inline">\(i\)</span> a posição do elemento no vetor. O <strong>tamanho de um vetor</strong> é o seu número de elementos.</p>
<p>O <strong>módulo de um vetor</strong> é o seu comprimento</p>
<p><span class="math display">\[
|\mathbf{a}| = \sqrt{a_1^2 + \ldots + a_n^2}.
\]</span></p>
<p>O vetor unitário é o vetor com comprimento <span class="math inline">\(1\)</span>. Podemos padronizar um vetor qualquer para ter tamanho <span class="math inline">\(1\)</span> dividindo cada elemento do vetor pelo seu comprimento,</p>
<p><span class="math display">\[
\hat{\mathbf{a}} =  \frac{\mathbf{a}}{|\mathbf{a}|}.
\]</span></p>
<p>Dizemos que dois vetores são iguais se têm o mesmo tamanho e se todos os seus elementos em posições equivalentes são iguais.</p>
<section id="operações-com-vetores" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="operações-com-vetores"><span class="header-section-number">2.1.1</span> Operações com vetores</h3>
<p>Da mesma forma que podemos fazer operações soma, subtração, multiplicação e divisão com números (no contexto de Álgebra Linear são chamados de <strong>escalares</strong>) também podemos fazer operações com vetores. No entanto, nem todas as operações usuais de escalares são válidas para vetores. De forma geral, vetores podem ser somados, subtraídos e multiplicados de forma especial. Porém, vetores não podem ser divididos e existem algumas operações especiais com vetores como o produto interno. Dois vetores podem ser somados ou subtraídos apenas se forem do mesmo tipo (linha ou coluna) e do mesmo tamanho. Para definirmos as operações com vetores, considere dois vetores <span class="math inline">\(\mathbf{a}\)</span> e <span class="math inline">\(\mathbf{b}\)</span> adequados, ou seja, mesmo tipo e tamanho, e <span class="math inline">\(\alpha\)</span> um escalar, as seguintes operações são bem definidas:</p>
<ol type="1">
<li>Soma: <span class="math inline">\(\mathbf{a} + \mathbf{b} = (a_i + b_i) = (a_1 + b_1, \ldots, a_n + b_n).\)</span></li>
<li>Subtração: <span class="math inline">\(\mathbf{a} - \mathbf{b} = (a_i - b_i) = (a_1 - b_1, \ldots, a_n - b_n).\)</span></li>
<li>Multiplicação por escalar: <span class="math inline">\(\alpha \mathbf{a} = (\alpha a_1, \ldots, \alpha a_n)\)</span>.</li>
<li>Transposta de um vetor: a operação transposta transforma um <strong>vetor coluna</strong> em um <strong>vetor linha</strong> e vice-versa. Por exemplo,</li>
</ol>
<p><span class="math display">\[
\mathbf{a} = \begin{pmatrix}
a_1 &amp; \ldots &amp; a_n
\end{pmatrix} \quad  \quad \mathbf{a}^{\top} = \begin{pmatrix}
a_1 \\
\vdots \\
a_n
\end{pmatrix}.
\]</span></p>
<ol start="5" type="1">
<li>Produto interno ou escalar entre dois vetores resulta em um escalar:</li>
</ol>
<p><span class="math display">\[
\mathbf{a} \cdot \mathbf{b} = (a_1 b_1 + a_2 b_2 + \ldots + a_n b_n).
\]</span></p>
<p>O co-seno do ângulo <span class="math inline">\(\theta\)</span> entre os vetores <span class="math inline">\(\mathbf{a}\)</span> e <span class="math inline">\(\mathbf{b}\)</span> é dado por:</p>
<p><span class="math display">\[
\begin{equation}    
\cos(\theta)=\frac{\mathbf{a}^{\top}\mathbf{b}}{\sqrt{\mathbf{a}^{\top}\mathbf{a}}\sqrt{\mathbf{b}^{\top}\mathbf{b}}}.
\end{equation}
\]</span></p>
<p>Dizemos que dois vetores são <strong>ortogonais</strong> entre si se o ângulo <span class="math inline">\(\theta\)</span> entre eles é 90º o que implica que <span class="math inline">\(\cos(\theta)=0\)</span> e que <span class="math inline">\(\mathbf{a}^{\top} \mathbf{b}=0\)</span>. Todas as operações descritas para vetores são trivialmente definidas em <code>R</code>. Vamos ver alguns exemplos. Para declarar um vetor em <code>R</code> usamos a função <code>c()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sendo os vetores compatíveis podemos facilmente somá-los, subtraí-los, multiplicar por um escalar ou obter o produto interno, conforme ilustrado no Código 2.1. Porém, cabe enfatizar que a divisão entre vetores não é definida.</p>
<p><strong>Código 2.1</strong> Operações com vetores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Soma</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>a <span class="sc">+</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5 7 9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Subtração</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>a <span class="sc">-</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 3 3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiplicação por escalar</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="sc">*</span> a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 50 60</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Produto interno</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>a <span class="sc">%*%</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   32</code></pre>
</div>
</div>
<p>Neste ponto é importante falar sobre a <strong>lei da reciclagem</strong> em <code>R</code> e dos cuidados que devemos ter ao fazer operações com vetores.</p>
<p>Vamos definir dois vetores, <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span>, porém de tamanhos diferentes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>a <span class="sc">+</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  5  7  9  6  8 10</code></pre>
</div>
</div>
<p>Note que apesar dos vetores não serem compatíveis para a soma, o <code>R</code> realizou alguma operação. É neste ponto que aparece a <strong>lei da reciclagem</strong>. Veja que os três primeiros elementos do vetor resultante da soma de <code>a + b</code> são <span class="math inline">\(4 + 1 = 5; 5 + 2 = 7\)</span> e <span class="math inline">\(6 + 3 = 9\)</span>. Porém, o <code>R</code> ainda reporta mais três números que são o resultado de <span class="math inline">\(5 + 1 = 6; 6 + 2 = 8\)</span> e <span class="math inline">\(7 + 3 = 10\)</span>, ou seja, o <code>R</code> reciclou os elementos do vetor <code>b</code> para completar a tarefa de somar <code>a + b</code>. Portanto, é muito importante tomar cuidado ao fazer operações com vetores em <code>R</code>.</p>
<p>Um outro ponto importante é a forma de fazer a multiplicação entre vetores. Veja o uso do operador especial <code>%*%</code> para a multiplicação entre vetores. O símbolo usual de multiplicação <code>*</code> não realiza a multiplicação vetorial, mas sim uma multiplicação elemento por elemento, também chamada de produto de Hadamard.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiplicação elemento a elemento (Hadamard)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>a<span class="sc">*</span>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  4 10 18</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiplicação entre vetores</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>a<span class="sc">%*%</span>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   32</code></pre>
</div>
</div>
<p>Usando as operações com vetores podemos facilmente calcular o co-seno do ângulo <span class="math inline">\(\theta\)</span> entre dois vetores compatíveis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cos_theta <span class="ot">&lt;-</span> <span class="fu">t</span>(a)<span class="sc">%*%</span>b<span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="fu">t</span>(a)<span class="sc">%*%</span>a)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">t</span>(b)<span class="sc">%*%</span>b))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>cos_theta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.9746318</code></pre>
</div>
</div>
</section>
</section>
<section id="matrizes" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="matrizes"><span class="header-section-number">2.2</span> Matrizes</h2>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Definição 2.2</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Uma <strong>matriz</strong> é um arranjo retangular ou quadrado de números ou variáveis. Uma matriz <span class="math inline">\((n \times m)\)</span> tem <span class="math inline">\(n\)</span> linhas e <span class="math inline">\(m\)</span> colunas:</p>
<p><span class="math display">\[
\mathbf{A} = \begin{pmatrix}
a_{11} &amp; a_{12} &amp; \ldots &amp; a_{1m} \\
a_{21} &amp; a_{22} &amp; \ddots &amp; a_{2m} \\
\vdots &amp; \vdots &amp; \ddots &amp;  \vdots \\
a_{n1} &amp; \ldots &amp; \ldots &amp; a_{nm}
\end{pmatrix}.
\]</span></p>
</div>
</div>
<p>Em termos de notação, nós vamos usar letras maiúsculas em negrito para representar uma matriz, por exemplo: <span class="math inline">\(\mathbf{A}\)</span>. Neste livro os elementos de uma matriz serão números reais ou variáveis representando números reais. Por exemplo, a matriz <span class="math inline">\(\mathbf{A}\)</span> representa as notas e o número de faltas de três alunos do curso de estatística básica. Cada linha representa um aluno, a primeira coluna a nota e a segunda o número de faltas.</p>
<p><span class="math display">\[
\mathbf{A} = \begin{pmatrix}
80 &amp; 0 \\
95 &amp; 1 \\
70 &amp; 5
\end{pmatrix}.
\]</span></p>
<p>Para representar os elementos da matriz como variáveis ou incógnitas, usamos letras minúsculas, por exemplo,</p>
<p><span class="math display">\[
\mathbf{A} = \begin{pmatrix}
a_{11} &amp; a_{12} \\
a_{21} &amp; a_{22} \\
a_{31} &amp; a_{32}
\end{pmatrix}.
\]</span></p>
<p>Vamos adotar que o primeiro subscrito representa linha e o segundo a coluna do elemento, ou seja, <span class="math inline">\(a_{\text{linha}\;\text{coluna}}\)</span>. Assim, podemos representar a matriz também por meio dos seus elementos, <span class="math inline">\(\mathbf{A} = a_{ij}\)</span> para <span class="math inline">\(i=1, \ldots, n\)</span> e <span class="math inline">\(j=1, \ldots, m\)</span> onde <span class="math inline">\(n\)</span> e <span class="math inline">\(m\)</span> são o número de linhas e colunas da matriz, respectivamente. Para o exemplo dos alunos, temos <span class="math inline">\(n = 3\)</span> e <span class="math inline">\(m = 2\)</span>. É comum referenciar uma matriz pela sua dimensão ou tamanho, ou seja, o número de linhas e colunas. Dizemos, então que <span class="math inline">\(\mathbf{A}\)</span> tem dimensão <span class="math inline">\(n \times m\)</span>, leia-se “A matriz <span class="math inline">\(\mathbf{A}\)</span> tem dimensão <span class="math inline">\(n\)</span> por <span class="math inline">\(m\)</span>.” Particularizando para o nosso exemplo <span class="math inline">\(\mathbf{A}\)</span> é <span class="math inline">\(3 \times 2\)</span>. Note que um vetor é simplesmente uma matriz com apenas uma linha ou uma coluna. De forma similar, podemos pensar que um escalar é apenas uma matriz de dimensão <span class="math inline">\(1 \times 1\)</span>. No entanto, um escalar é tecnicamente diferente de uma matriz <span class="math inline">\(1 \times 1\)</span> em termos de aplicações e propriedades em Álgebra Linear. Tais diferenças ficarão claras no decorrer do Capítulo. Dizemos que duas matrizes são iguais se tem a mesma dimensão e se os elementos das correspondentes posições são iguais. A operação de transpor também é definida para matrizes de forma similar ao realizado para vetores. Assim, a operação de transposição rearranja uma matriz de forma que suas linhas são transformadas em colunas e vice-versa. Considere o exemplo,</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 2\\
3 &amp; 4\\
5 &amp; 6
\end{pmatrix}^{\top} =
\begin{pmatrix}
1 &amp; 3 &amp; 5\\
2 &amp; 4 &amp; 6
\end{pmatrix}.
\]</span></p>
<p>Além disso, é claro que <span class="math inline">\((\mathbf{A}^{\top})^{\top} = \mathbf{A}\)</span>, ou seja, a transposta da transposta de uma matriz é a matriz original. Para definir uma matriz em <code>R</code> usamos o comando <code>matrix()</code> que permite rearranjar um vetor em uma matriz. O Código 2.2 define uma matriz <span class="math inline">\(3 \times 2\)</span> em <code>R</code>.</p>
<p><strong>Código 2.2</strong> Inicialização de uma matriz.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(a, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6</code></pre>
</div>
</div>
<p>Por <em>default </em> o <code>R</code> vai preencher a matriz por coluna. Assim, os primeiros três valores do vetor formam a primeira coluna, enquanto que os três últimos formam a segunda coluna. Os argumentos <code>nrow</code> e <code>ncol</code> definem o número de linhas e colunas da matriz resultante. É possível também preencher a matriz por linhas, caso seja de interesse. Neste caso usamos o argumento <code>byrow = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(a, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    2
[2,]    3    4
[3,]    5    6</code></pre>
</div>
</div>
<p>A transposição de uma matriz ou vetor é realizada pela função <code>t()</code>, conforme ilustrado no Código 2.3.</p>
<p><strong>Código 2.3</strong> Transposta de uma matriz.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Transposta de uma matriz</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6</code></pre>
</div>
</div>
<section id="operações-com-matrizes" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="operações-com-matrizes"><span class="header-section-number">2.2.1</span> Operações com matrizes</h3>
<p>Algumas operações entre matrizes e vetores também são definidas. Qualquer escalar pode ser multiplicado por qualquer matriz da seguinte forma:</p>
<p><span class="math display">\[
\alpha \mathbf{A} = \begin{pmatrix}
\alpha a_{11} &amp; \alpha a_{12} &amp; \ldots &amp; \alpha a_{1m} \\
\alpha a_{21} &amp; \alpha a_{22} &amp; \ddots &amp; \alpha a_{2m} \\
\vdots &amp; \vdots &amp; \ddots &amp;  \vdots \\
\alpha a_{n1} &amp; \ldots &amp; \ldots &amp; \alpha a_{nm}
\end{pmatrix}.
\]</span></p>
<p>Em palavras, multiplicar um escalar por uma matriz é simplesmente multiplicar cada entrada da matriz pelo escalar de interesse. O resultado é uma matriz de mesma dimensão da matriz original. Note ainda que <span class="math inline">\(\alpha \mathbf{A} = \mathbf{A} \alpha\)</span>. O código 2.4 ilustra tal operação em <code>R</code>.</p>
<p><strong>Código 2.4</strong> Multiplicação de escalar por matriz.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="sc">*</span>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   10   40
[2,]   20   50
[3,]   30   60</code></pre>
</div>
</div>
<p>Duas matrizes podem ser somadas ou subtraídas somente se tiverem o mesmo tamanho. O resultado da soma ou subtração de duas matrizes <span class="math inline">\(\mathbf{A}\)</span> e <span class="math inline">\(\mathbf{B}\)</span> ambas <span class="math inline">\((n \times m)\)</span> é uma matriz <span class="math inline">\(\mathbf{C}\)</span> de mesmo tamanho cujos elementos são dados por:</p>
<ol type="1">
<li>Soma <span class="math inline">\(c_{ij} = a_{ij} + b_{ij}.\)</span></li>
<li>Subtração <span class="math inline">\(c_{ij} = a_{ij} - b_{ij}.\)</span></li>
</ol>
<p>Por exemplo,</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 2\\
3 &amp; 4\\
5 &amp; 6
\end{pmatrix} + \begin{pmatrix}
10 &amp; 20\\
30 &amp; 40 \\
50 &amp; 60
\end{pmatrix} =
\begin{pmatrix}
11 &amp; 22\\
33 &amp; 44\\
55 &amp; 66
\end{pmatrix}.
\]</span></p>
<p>O Código 2.5 ilustra a soma de matrizes em <code>R</code>.</p>
<p><strong>Código 2.5</strong> Soma de matrizes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> A <span class="sc">+</span> B</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   11   44
[2,]   22   55
[3,]   33   66</code></pre>
</div>
</div>
<p>A multiplicação <span class="math inline">\(\mathbf{C} = \mathbf{A} \mathbf{B}\)</span> é definida apenas quando o número de colunas de <span class="math inline">\(\mathbf{A}\)</span> é igual ao número de linhas de <span class="math inline">\(\mathbf{B}\)</span>. <span class="math inline">\(\underset{m \times n}{\mathbf{C}} = \underset{m \times q}{\mathbf{A}} \underset{q \times n}{\mathbf{B}}\)</span>. Cada elemento <span class="math inline">\(c_{ij} = \sum_{k = 1}^q a_{ik} b_{kj}.\)</span></p>
<p>Por exemplo,</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; -1\\
8 &amp; 3\\
6 &amp; 7
\end{pmatrix} \begin{pmatrix}
4 &amp; 9 &amp; 1 &amp; -3\\
-5 &amp; 2 &amp; 4 &amp; 6
\end{pmatrix} =
\]</span></p>
<p><span class="math display">\[
\begin{pmatrix}
(2 \cdot 4 + -1 \cdot-5) &amp; (2\cdot 9 + -1 \cdot 2) &amp; (2\cdot1 + -1 \cdot 4) &amp; (2 \cdot -3 + -1 \cdot 6) \\
(8\cdot 4 + 3 \cdot -5) &amp; (8\cdot 9 + 3 \cdot 2)  &amp; (8 \cdot 1 + 3 \cdot 4) &amp; (8 \cdot -3 + 3 \cdot 6) \\
(6\cdot4 + 7\cdot -5) &amp; (6 \cdot 9 + 7 \cdot 2)  &amp; (6 \cdot 1 + 7 \cdot 4) &amp; (6 \cdot - 3 + 7 \cdot 6)
\end{pmatrix} =
\]</span></p>
<p><span class="math display">\[
\begin{pmatrix}
13 &amp; 16 &amp; -2 &amp; -12\\
17 &amp; 78 &amp; 20 &amp; -6\\
-11 &amp; 68 &amp; 34 &amp; 24
\end{pmatrix}.
\]</span></p>
<p>O Código 2.6 ilustra a multiplicação de matrizes em <code>R</code>. Novamente note o uso do operador especial <code>%*%</code> ao invés do símbolo usual de multiplicação <code>*</code>.</p>
<p><strong>Código 2.6</strong> Multiplicação de matrizes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">7</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">9</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">6</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> A<span class="sc">%*%</span>B</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]   13   16   -2  -12
[2,]   17   78   20   -6
[3,]  -11   68   34   24</code></pre>
</div>
</div>
<p>Em geral <span class="math inline">\(\mathbf{A} \mathbf{B} \neq \mathbf{B} \mathbf{A}\)</span>. Veja que no caso das matrizes do exemplo anterior <span class="math inline">\(\mathbf{B}\)</span> tem dimensão <span class="math inline">\(2\times 4\)</span>, enquanto <span class="math inline">\(\mathbf{A}\)</span> tem dimensão <span class="math inline">\(3 \times 2\)</span>, e portanto o produto não pode ser feito. Apenas como ilustração o Código 2.7 tenta realizar a multiplicação entre duas matrizes não compatíveis.</p>
<p><strong>Código 2.7</strong> Multiplicação de matrizes não compatíveis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>B <span class="sc">%*%</span> A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in B %*% A: argumentos não compatíveis</code></pre>
</div>
</div>
<p>Neste caso o <code>R</code> retorna uma mensagem de erro indicando que as matrizes não são compatíveis para multiplicação. Algumas propriedades da multiplicação de matrizes são apresentadas a seguir. Sendo <span class="math inline">\(\mathbf{A}, \mathbf{B}, \mathbf{C}\)</span> e <span class="math inline">\(\mathbf{D}\)</span> compatíveis temos,</p>
<ol type="1">
<li><span class="math inline">\(\mathbf{A} + \mathbf{B} = \mathbf{B} + \mathbf{A}\)</span>.</li>
<li><span class="math inline">\((\mathbf{A} + \mathbf{B}) + \mathbf{C} = \mathbf{A} + (\mathbf{B} + \mathbf{C}).\)</span></li>
<li><span class="math inline">\(\alpha (\mathbf{A} + \mathbf{B}) = \alpha \mathbf{A} + \alpha \mathbf{B}.\)</span></li>
<li><span class="math inline">\((\alpha + \beta) \mathbf{A} = \alpha \mathbf{A} + \beta \mathbf{A}.\)</span></li>
<li><span class="math inline">\(\alpha(\mathbf{A}\mathbf{B}) = (\alpha \mathbf{A})\mathbf{B} = \mathbf{A}(\alpha \mathbf{B}).\)</span></li>
<li><span class="math inline">\(\mathbf{A}(\mathbf{B} \pm \mathbf{C}) = \mathbf{A}\mathbf{B} \pm \mathbf{A}\mathbf{C}.\)</span></li>
<li><span class="math inline">\((\mathbf{A} \pm \mathbf{B})\mathbf{C} = \mathbf{A}\mathbf{C} \pm \mathbf{B}\mathbf{C}.\)</span></li>
<li><span class="math inline">\((\mathbf{A} - \mathbf{B})(\mathbf{C} - \mathbf{D}) = \mathbf{A}\mathbf{C} - \mathbf{B}\mathbf{C} - \mathbf{A}\mathbf{D} + \mathbf{B}\mathbf{D}.\)</span></li>
</ol>
<p>Duas propriedades interessantes envolvendo transposta e multiplicação de matrizes são:</p>
<ol type="1">
<li>Se <span class="math inline">\(\mathbf{A}\)</span> é <span class="math inline">\(n \times m\)</span> e <span class="math inline">\(\mathbf{B}\)</span> é <span class="math inline">\(m \times n\)</span>, então</li>
</ol>
<p><span class="math display">\[
(\mathbf{A} \mathbf{B})^{\top} = \mathbf{B}^{\top} \mathbf{A}^{\top}.
\]</span></p>
<ol start="2" type="1">
<li>De maneira similar, se <span class="math inline">\(\mathbf{A}, \mathbf{B}\)</span> e <span class="math inline">\(\mathbf{C}\)</span> são compatíveis</li>
</ol>
<p><span class="math display">\[
(\mathbf{A} \mathbf{B} \mathbf{C} )^{\top} = \mathbf{C}^{\top} \mathbf{B}^{\top} \mathbf{A}^{\top}.
\]</span></p>
<p>Neste momento estamos aptos a fazer a distinção entre escalar e uma matriz <span class="math inline">\(1 \times 1\)</span>. Considere que <span class="math inline">\(\mathbf{a}\)</span> é uma matriz <span class="math inline">\(1 \times 1\)</span>. O produto de um escalar (<span class="math inline">\(\alpha\)</span>) por uma matriz está definido para qualquer matriz. Entretanto, uma matriz <span class="math inline">\(1 \times 1\)</span> só pode ser multiplicada por um vetor <span class="math inline">\(\mathbf{b}\)</span> (<span class="math inline">\(1 \times n\)</span>, vetor linha) pela direita, ou seja, <span class="math inline">\(\mathbf{a} \mathbf{b}\)</span> ou pela esquerda por um vetor <span class="math inline">\(\mathbf{b}\)</span> (<span class="math inline">\(n \times 1\)</span>, vetor coluna) pela esquerda <span class="math inline">\(\mathbf{b} \mathbf{a}\)</span>. O Código 2.8 ilustra esta situação.</p>
<p><strong>Código 2.8</strong> Ilustração da diferença entre escalar e matriz <span class="math inline">\(1 \times 1\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">10</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(a) <span class="co"># Dimensão de a</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(b) <span class="do">## Dimensão de b</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>a<span class="sc">%*%</span>b <span class="co"># Compatível</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]   10   20   30   40</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>b<span class="sc">%*%</span>a <span class="do">## Não compatível</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in b %*% a: argumentos não compatíveis</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(b)<span class="sc">%*%</span>a <span class="do">## Compatível</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   10
[2,]   20
[3,]   30
[4,]   40</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="sc">*</span>b <span class="co"># Escalar com matriz</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]   10   20   30   40</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>b<span class="sc">*</span>alpha <span class="co"># Escalar com matriz</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]   10   20   30   40</code></pre>
</div>
</div>
<p>Um outro tipo de produto entre vetores ou matrizes é o chamado <strong>produto de Hadamard</strong>. Sendo duas matrizes ou dois vetores de mesmo tamanho o produto de Hadamard é simplesmente o resultado da multiplicação direta dos elementos correspondentes:</p>
<p><span class="math display">\[
\mathbf{A} \odot  \mathbf{B} = \begin{pmatrix}
a_{11} b_{11} &amp; a_{12} b_{12} &amp; \cdots &amp; a_{1m}b_{1m} \\
a_{21} b_{21} &amp; a_{22} b_{22} &amp; \cdots &amp; a_{2m} b_{2m} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots\\
a_{n1} b_{n1} &amp; a_{n2} b_{n2} &amp; \cdots &amp; a_{nm} b_{nm}
\end{pmatrix}.
\]</span></p>
<p>Estamos usando a notação <span class="math inline">\(\odot\)</span> para diferenciar o produto de Hadamard do produto matricial usual. Em <code>R</code> este produto é obtido usando o operador <code>*</code> usual, conforme ilustrado no Código 2.9.</p>
<p><strong>Código 2.9</strong> Produto de Hadamard.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>A<span class="sc">*</span>B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   10   90
[2,]   40  160</code></pre>
</div>
</div>
</section>
<section id="matrizes-de-formas-especiais" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="matrizes-de-formas-especiais"><span class="header-section-number">2.2.2</span> Matrizes de formas especiais</h3>
<p>Nesta subseção veremos algumas matrizes com formas especiais.</p>
<p>Dizemos que uma matriz é quadrada quando tem o mesmo número de linhas e colunas. Por exemplo,</p>
<p><span class="math display">\[
\mathbf{A} = \begin{pmatrix}
a_{11} &amp; a_{12} &amp; a_{13} &amp; a_{14} \\
a_{21} &amp; a_{22} &amp; a_{23} &amp; a_{24} \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; a_{34} \\
a_{41} &amp; a_{42} &amp; a_{43} &amp; a_{44}
\end{pmatrix}.
\]</span></p>
<p>Chamamos os elementos <span class="math inline">\(a_{ii}\)</span> de elementos <strong>diagonais</strong> ou da diagonal. Já os elementos <span class="math inline">\(a_{ij}\)</span> para <span class="math inline">\(i \neq j\)</span> são chamados de elementos <strong>fora da diagonal</strong>. Os elementos <span class="math inline">\(a_{ij}\)</span> para <span class="math inline">\(j &gt; i\)</span> são os elementos <strong>acima da diagonal</strong> e os elementos <span class="math inline">\(a_{ij}\)</span> para <span class="math inline">\(i &gt; j\)</span> são os elementos <strong>abaixo da diagonal</strong>.</p>
<p>Uma matriz é diagonal se apenas os elementos diagonais são diferentes de zero. Por exemplo,</p>
<p><span class="math display">\[
\mathbf{D} = \begin{pmatrix}
a_{11} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; a_{22} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; a_{33} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; a_{44}
\end{pmatrix}.
\]</span></p>
<p>Uma matriz é triangular superior se os elementos abaixo da diagonal são todos iguais a zero. É comum denotar uma matriz triangular superior por <span class="math inline">\(\mathbf{U}\)</span> do Inglês <em>upper </em>.</p>
<p><span class="math display">\[
\mathbf{U} = \begin{pmatrix}
a_{11} &amp; a_{12} &amp; a_{13} &amp; a_{14} \\
0 &amp; a_{22} &amp; a_{23} &amp; a_{24} \\
0 &amp; 0 &amp; a_{33} &amp; a_{34} \\
0 &amp; 0 &amp; 0 &amp; a_{44}
\end{pmatrix}.
\]</span></p>
<p>Por outro lado, uma matriz é triangular inferior se os elementos acima da diagonal são todos iguais a zero. Neste caso a notação usual é <span class="math inline">\(\mathbf{L}\)</span> do Inglês <em>lower </em>.</p>
<p><span class="math display">\[
\mathbf{L} = \begin{pmatrix}
a_{11} &amp; 0 &amp; 0 &amp; 0 \\
a_{21} &amp; a_{22} &amp; 0 &amp; 0 \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; 0 \\
a_{41} &amp; a_{42} &amp; a_{43} &amp; a_{44}
\end{pmatrix}.
\]</span></p>
<p>A matriz identidade é uma matriz diagonal onde os elementos diagonais são todos iguais a <span class="math inline">\(1\)</span>. A notação usual é <span class="math inline">\(\mathbf{I}\)</span> do Inglês <em>identity </em>.</p>
<p><span class="math display">\[
\mathbf{I} = \begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1
\end{pmatrix}.
\]</span></p>
<p>A matriz zero ou nula é aquela cuja todas as entradas são iguais a zero, ou seja,</p>
<p><span class="math display">\[
\mathbf{0} = \begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0
\end{pmatrix}.
\]</span></p>
<p>Uma matriz quadrado é dita ser simétrica se <span class="math inline">\(a_{ij} = a_{ji}\)</span>. De forma equivalente, se <span class="math inline">\(\mathbf{A}^{\top} = \mathbf{A}\)</span>, então <span class="math inline">\(\mathbf{A}\)</span> é simétrica. Por exemplo,</p>
<p><span class="math display">\[
\mathbf{A} = \begin{pmatrix}
1 &amp; 0.8 &amp; 0.6 &amp; 0.4 \\
0.8 &amp; 1 &amp; 0.2 &amp; 0.4 \\
0.6 &amp; 0.2 &amp; 1 &amp; 0.1 \\
0.4 &amp; 0.4 &amp; 0.1 &amp; 1
\end{pmatrix}.
\]</span></p>
</section>
<section id="rank-e-inversa-de-uma-matriz" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="rank-e-inversa-de-uma-matriz"><span class="header-section-number">2.2.3</span> <em>Rank </em> e inversa de uma matriz</h3>
<p>Na seção 2.2.1 vimos diversas operações com matrizes. Muitas destas operações são extensões das operações de soma, subtração e multiplicação de escalares. No entanto, a divisão entre matrizes não foi definida. De forma geral duas matrizes não podem ser divididas, porém existe um tipo especial de matriz que tenta de certa forma estender a operação de divisão entre escalares para matrizes. Essa matriz especial é chamada de <strong>matriz inversa</strong>. Porém, a sua obtenção está limitada a um certo conjunto de matrizes que são chamadas <strong>não singulares</strong>. Nesta seção nós vamos entender o que é uma matriz não singular e como avaliar se uma matriz qualquer é ou não singular por meio da avaliação do seu <em>rank </em>, também chamado de <strong>posto</strong>.</p>
<p>Para definir o que é o <em>rank </em> de uma matriz precisamos da noção de <strong>dependência</strong> e <strong>independência linear</strong>. Um conjunto de vetores <span class="math inline">\(\mathbf{a}_1, \mathbf{a}_2, \ldots, \mathbf{a}_n\)</span> é dito ser <strong>linearmente dependente</strong> se escalares <span class="math inline">\(c_1, c_2, \ldots, c_n\)</span> não todos iguais a zero puderem ser encontrados de tal forma que</p>
<p><span class="math display">\[
\begin{equation}
c_1 \mathbf{a}_1 + c_2 \mathbf{a}_2 + \ldots + c_n \mathbf{a}_n = 0.
\tag{2.1}
\end{equation}
\]</span></p>
<p>No caso em que os coeficientes <span class="math inline">\(c_1, c_2, \ldots, c_n\)</span> não puderem ser encontrados satisfazendo (2.1) o conjunto de vetores <span class="math inline">\(\mathbf{a}_1, \mathbf{a}_2, \ldots, \mathbf{a}_n\)</span> é dito ser <strong>linearmente independente</strong>. Note que a Equação (2.1) pode ser reescrita em formato matricial, onde os vetores <span class="math inline">\(\mathbf{a}_1, \mathbf{a}_2, \ldots, \mathbf{a}_n\)</span> formam as colunas de uma matriz <span class="math inline">\(\mathbf{A}\)</span> e os escalares são empilhados em um vetor <span class="math inline">\(\mathbf{c}\)</span>. Assim,</p>
<p><span class="math display">\[
\mathbf{A} \mathbf{c} = \mathbf{0}.
\]</span></p>
<p>Neste caso as colunas de <span class="math inline">\(\mathbf{A}\)</span> são linearmente independentes se <span class="math inline">\(\mathbf{A} \mathbf{c} = \mathbf{0}\)</span> implicar que <span class="math inline">\(\mathbf{c} = 0\)</span>. Intuitivamente um conjunto de vetores linearmente dependentes é de alguma forma redundante, no sentido de que um dos vetores pode ser escrito como uma combinação linear dos outros.</p>
<p>Considere um exemplo trivial com os vetores <span class="math inline">\(\mathbf{a}_1 = (1,0)\)</span> e <span class="math inline">\(\mathbf{a}_2 = (0,1)\)</span>. Veja que qualquer outro vetor de tamanho dois pode ser escrito como uma combinação linear dos vetores <span class="math inline">\(\mathbf{a}_1\)</span> e <span class="math inline">\(\mathbf{a}_2\)</span>. Assim, qualquer outro vetor de tamanho dois concatenado com <span class="math inline">\(\mathbf{a}_1\)</span> e <span class="math inline">\(\mathbf{a}_2\)</span> em uma matriz <span class="math inline">\(\mathbf{A}\)</span> tornará as colunas de <span class="math inline">\(\mathbf{A}\)</span> linearmente dependentes. Porém, uma matriz <span class="math inline">\(\mathbf{A}\)</span> formada apenas por <span class="math inline">\(\mathbf{a}_1\)</span> e <span class="math inline">\(\mathbf{a}_2\)</span> tem colunas linearmente independentes.</p>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Definição 2.3</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>O <em>rank </em> ou <strong>posto</strong> de qualquer matriz quadrada ou retangular <span class="math inline">\(\mathbf{A}\)</span> é definido como</p>
<p><span class="math display">\[
\mathrm{rank}(\mathbf{A}) = \text{número de colunas ou linhas linearmente independentes em } \mathbf{A}.
\]</span></p>
</div>
</div>
<p>Pode ser provado que o número de linhas e colunas linearmente independentes em uma matriz qualquer é sempre o mesmo. Se uma matriz <span class="math inline">\(\mathbf{A}\)</span> tem apenas um elemento diferente de zero, então <span class="math inline">\(\mathrm{rank}(\mathbf{A}) = 1\)</span>. O <span class="math inline">\(\mathrm{rank}\)</span> da matriz nula é <span class="math inline">\(0\)</span>.</p>
<p>Sendo <span class="math inline">\(\mathbf{A}\)</span> uma matriz retangular <span class="math inline">\(n \times m\)</span> o maior <em>rank </em> possível para <span class="math inline">\(\mathbf{A}\)</span> é o <span class="math inline">\(\min(n,m)\)</span>. Quando o <em>rank </em> da matriz é o <span class="math inline">\(\min(n,m)\)</span> dizemos que a matriz tem <em>rank </em> completo ou é de posto completo. Importante salientar que qualquer matriz retangular terá colunas linearmente dependentes. Com os conceitos apresentados até aqui podemos finalmente definir o que entendemos por uma <strong>matriz não singular</strong> e <strong>matriz inversa</strong>.</p>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Definição 2.4</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Uma matriz quadrada de <strong>posto completo</strong> é chamada de <strong>não singular</strong>.</p>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Definição 2.5</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dada uma matriz quadrada <span class="math inline">\(\mathbf{A}\)</span> de posto completo a <strong>matriz inversa</strong> de <span class="math inline">\(\mathbf{A}\)</span> denotada por <span class="math inline">\(\mathbf{A}^{-1}\)</span> é única tal que</p>
<p><span class="math display">\[
\mathbf{A}\mathbf{A}^{-1} = \mathbf{I}.
\]</span></p>
</div>
</div>
<p>Se a matriz <span class="math inline">\(\mathbf{A}\)</span> não for quadrada e de posto completo, então <span class="math inline">\(\mathbf{A}\)</span> não terá inversa e é dita ser <strong>singular</strong>. Baseado na Definição 2.5 é fácil ver que <span class="math inline">\((\mathbf{A}^{-1})^{-1} = \mathbf{A}.\)</span></p>
<p>Em aplicações reais obter a inversa de uma matriz é uma tarefa complexa e requer o uso de algoritmos numéricos. Nós vamos ver algumas opções na Seção 2.3 quando discutiremos algoritmos para a solução de sistemas de equações lineares.</p>
<p>A intuição da matriz inversa é poder fazer operações similares a que realizamos com escalares quando estamos resolvendo sistemas de equações lineares. Lembre-se do sistema de equações lineares representado nas Equações (1.14) e (1.15) no modelo de regressão linear simples.</p>
<p>No decorrer deste livro seremos frequentemente confrontados com sistemas lineares do tipo <span class="math inline">\(\mathbf{A} \mathbf{x} = \mathbf{c}\)</span> em que precisamos encontrar o vetor de incógnitas <span class="math inline">\(\mathbf{x}\)</span>. No caso em que <span class="math inline">\(\mathbf{A}\)</span> é não singular, o sistema de equações <span class="math inline">\(\mathbf{A} \mathbf{x} = \mathbf{c}\)</span> terá uma única solução dada por <span class="math inline">\(\mathbf{x} = \mathbf{A}^{-1} \mathbf{c}\)</span>. Veja como a inversa imita o que costumamos fazer com escalares quando resolvendo uma simples equação linear. É o equivalente ao que falamos grosseiramente de “passa pro outro lado.” O que realmente está sendo feito é que multiplicamos o sistema em ambos os lados por <span class="math inline">\(\mathbf{A}^{-1}\)</span> para obter a solução, ou seja,</p>
<p><span class="math display">\[
\begin{eqnarray}
\mathbf{A}^{-1} \mathbf{A} \mathbf{x} &amp;=&amp; \mathbf{A}^{-1} \mathbf{c} \\
\mathbf{I}\mathbf{x} &amp;=&amp; \mathbf{A}^{-1} \mathbf{c}.
\end{eqnarray}
\]</span></p>
<p>Em <code>R</code> podemos facilmente obter a inversa de uma matriz usando a função <code>solve()</code>. No entanto, como ficará claro quando discutirmos métodos para a solução de sistemas lineares, tal solução é cara computacionalmente e raramente necessária explicitamente. O Código 2.10 ilustra a obtenção da inversa.</p>
<p><strong>Código 2.10</strong> Inversa de uma matriz.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">6</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>A_inv <span class="ot">&lt;-</span> <span class="fu">solve</span>(A)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Conferindo: deve resultar na matriz identidade</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>A<span class="sc">%*%</span>A_inv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    0
[2,]    0    1</code></pre>
</div>
</div>
<p>Duas propriedades importantes envolvendo multiplicação e inversão de matrizes são:</p>
<ol type="1">
<li><p>Se <span class="math inline">\(\mathbf{A}\)</span> é não singular, então <span class="math inline">\(\mathbf{A}^{\top}\)</span> é não singular e sua inversa é dada por <span class="math display">\[
(\mathbf{A}^{\top})^{-1} = (\mathbf{A}^{-1})^{\top}.
\]</span></p></li>
<li><p>Se <span class="math inline">\(\mathbf{A}\)</span> e <span class="math inline">\(\mathbf{B}\)</span> são matrizes não singulares de mesmo tamanho, então o produto <span class="math inline">\(\mathbf{A} \mathbf{B}\)</span> é não singular e <span class="math display">\[
(\mathbf{A} \mathbf{B})^{-1} =  \mathbf{B}^{-1} \mathbf{A}^{-1}.
\]</span></p></li>
</ol>
<p>No caso em que uma matriz é retangular não podemos obter a inversa. Nestes casos podemos recorrer a matriz <strong>inversa generalizada</strong>.</p>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Definição 2.6</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>inversa generalizada</strong> de uma matriz <span class="math inline">\(\mathbf{A}\)</span> <span class="math inline">\(n \times p\)</span> é qualquer matriz <span class="math inline">\(\mathbf{A}^{-}\)</span> que satisfaça</p>
<p><span class="math display">\[
\mathbf{A}\mathbf{A}^{-}\mathbf{A} = \mathbf{A}.
\]</span></p>
</div>
</div>
<p>A inversa generalizada não é única exceto quando <span class="math inline">\(\mathbf{A}\)</span> é não-singular, e neste caso coincide com a inversa. Toda matriz, seja quadrada ou retangular tem uma inversa generalizada, isto inclui vetores. Como um exemplo ilustrativo, considere o vetor</p>
<p><span class="math display">\[
\mathbf{a} = \begin{pmatrix}
1\\
2\\
3\\
4
\end{pmatrix}.
\]</span></p>
<p>Neste caso o vetor <span class="math inline">\(\mathbf{a}^{-} = (1, 0, 0, 0)\)</span> é a inversa generalizada de <span class="math inline">\(\mathbf{a}\)</span>. Para verificar basta fazer a multiplicação matricial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="dv">4</span>, <span class="dv">1</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>a_invg <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>a<span class="sc">%*%</span>a_invg<span class="sc">%*%</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]    1
[2,]    2
[3,]    3
[4,]    4</code></pre>
</div>
</div>
<p>Importante notar que se <span class="math inline">\(\mathbf{A}\)</span> é <span class="math inline">\(n \times p\)</span>, então qualquer inversa generalizada de <span class="math inline">\(\mathbf{A}\)</span> terá dimensão <span class="math inline">\(p \times n\)</span>.</p>
<p>Como dito, a inversa generalizada não é única. Em particular a inversa generalizada chamada de Moore-Penrose (<em>Moore-Penrose Genereralized Inverse </em>) está implementada em <code>R</code> por meio do pacote <code>MASS</code>. O Código 2.11 ilustra a obtenção da inversa generalizada de Moore-Penrose para uma matriz quadrada, porém singular.</p>
<p><strong>Código 2.11</strong> Inversa generalizada de Moore-Penrose.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Matriz singular (a terceira coluna é a soma da primeira com a segunda)</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>), <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Carregando o pacote MASS</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>A_ginv <span class="ot">&lt;-</span> <span class="fu">ginv</span>(A)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Conferindo</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>A<span class="sc">%*%</span>A_ginv<span class="sc">%*%</span>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]         [,2] [,3]
[1,]    2 2.000000e+00    3
[2,]    1 2.220446e-16    1
[3,]    3 2.000000e+00    4</code></pre>
</div>
</div>
</section>
<section id="matrizes-positivas-definidas" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="matrizes-positivas-definidas"><span class="header-section-number">2.2.4</span> Matrizes positivas definidas</h3>
<p>No decorrer deste livro vamos encontrar frequentemente as chamadas somas de quadrados. Nós já discutimos sobre soma de quadrados nas seções 1.2.5 e 1.2.9 quando encontramos a média e os coeficientes de regressão do modelo de regressão linear simples. De forma matricial, a soma de quadrados pode ser reescritas usando <strong>formas quadráticas</strong>.</p>
<p>Considere uma matriz <span class="math inline">\(\mathbf{A}\)</span> simétrica e <span class="math inline">\(\mathbf{y}\)</span> um vetor, o produto</p>
<p><span class="math display">\[
\mathbf{y}^{\top} \mathbf{A} \mathbf{y} = \sum_{i} a_{ij} y_i^2 + \sum_{i \neq j} a_{ij} y_i y_j,
\]</span></p>
<p>é chamado de <strong>forma quadrática</strong>.</p>
<p>Para uma matriz <span class="math inline">\(\mathbf{y}\)</span> de dimensão <span class="math inline">\(n \times 1\)</span>, ou seja, um vetor coluna o produto matricial <span class="math inline">\(\mathbf{y}^{\top}\mathbf{I} \mathbf{y} = y_1^2 + y_2^2 + \ldots, y_n^2\)</span>. Assim, <span class="math inline">\(\mathbf{y}^{\top} \mathbf{y}\)</span> é a soma de quadrados dos elementos do vetor <span class="math inline">\(\mathbf{y}\)</span>. A raiz quadrado da soma de quadrados é a distância do ponto <span class="math inline">\(\mathbf{y}\)</span> até a origem, também chamada de comprimento de <span class="math inline">\(\mathbf{y}\)</span>. As somas de quadrados permanecem positivas, ou ao menos não negativas para todos os valores de <span class="math inline">\(\mathbf{y}\)</span> exceto no caso em que <span class="math inline">\(\mathbf{y} = 0\)</span>.</p>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Definição 2.7</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sendo <span class="math inline">\(\mathbf{A}\)</span> uma matriz simétrica com a propriedade <span class="math inline">\(\mathbf{y}^{\top} \mathbf{A} \mathbf{y} &gt; 0\)</span> para todos os possíveis <span class="math inline">\(\mathbf{y}\)</span> exceto para quando <span class="math inline">\(\mathbf{y} = 0\)</span>, então a forma quadrática <span class="math inline">\(\mathbf{y}^{\top} \mathbf{A} \mathbf{y}\)</span> é chamada <strong>positiva definida</strong>, e <span class="math inline">\(\mathbf{A}\)</span> é dita ser uma <strong>matriz positiva definida</strong>. No caso de <span class="math inline">\(\mathbf{y}^{\top} \mathbf{A} \mathbf{y} \geq 0\)</span> e existir ao menos um <span class="math inline">\(\mathbf{y} \neq 0\)</span> tal que <span class="math inline">\(\mathbf{y}^{\top} \mathbf{A} \mathbf{y} = 0\)</span>, então <span class="math inline">\(\mathbf{y}^{\top} \mathbf{A} \mathbf{y}\)</span> é dita ser <strong>positiva semi-definida</strong> e <span class="math inline">\(\mathbf{A}\)</span> é uma matriz <strong>positiva semi-definida</strong>.</p>
</div>
</div>
<p>Para ilustração considere a seguinte matriz</p>
<p><span class="math display">\[
\mathbf{A} = \begin{pmatrix}
2 &amp; -1\\
-1 &amp; 3
\end{pmatrix}.
\]</span></p>
<p>A forma quadrática associada é dada por</p>
<p><span class="math display">\[
\mathbf{y}^{\top} \mathbf{A} \mathbf{y} = \begin{pmatrix}
y_1 &amp; y_2
\end{pmatrix}
\begin{pmatrix}
2 &amp; -1\\
-1 &amp; 3
\end{pmatrix}
\begin{pmatrix}
y_1 \\
y_2
\end{pmatrix} = 2 y_1^2 - 2 y_1 y_2 + 3 y_2^2,
\]</span></p>
<p>que é claramente positiva, desde que <span class="math inline">\(y_1\)</span> e <span class="math inline">\(y_2\)</span> sejam diferentes de zero. Algumas propriedades interessantes sobre matrizes positivas definidas ou semi-definidas são:</p>
<ol type="1">
<li><span class="math inline">\(\mathbf{A}\)</span> é positiva definida, então todos os valores da diagonal de <span class="math inline">\(\mathbf{A}\)</span> são positivos.</li>
<li>Se <span class="math inline">\(\mathbf{A}\)</span> é positiva semi-definida, então os elementos da diagonal de <span class="math inline">\(\mathbf{A}\)</span> são maiores ou iguais a zero.</li>
<li>Sendo <span class="math inline">\(\mathbf{P}\)</span> uma matriz não-singular e <span class="math inline">\(\mathbf{A}\)</span> uma matriz positiva definida, o produto <span class="math inline">\(\mathbf{P}^{\top} \mathbf{A} \mathbf{P}\)</span> é uma matriz positiva definida.</li>
<li>Sendo <span class="math inline">\(\mathbf{P}\)</span> uma matriz não-singular e <span class="math inline">\(\mathbf{A}\)</span> uma matriz positiva semi-definida, o produto <span class="math inline">\(\mathbf{P}^{\top} \mathbf{A} \mathbf{P}\)</span> é uma matriz positiva semi-definida.</li>
<li>Uma matriz positiva definida é não-singular.</li>
</ol>
<p>Matrizes positivas definidas são fundamentais em estatística pois representam a matriz de variância e covariância de vetores aleatórios.</p>
</section>
<section id="determinante-e-traço-de-uma-matriz" class="level3" data-number="2.2.5">
<h3 data-number="2.2.5" class="anchored" data-anchor-id="determinante-e-traço-de-uma-matriz"><span class="header-section-number">2.2.5</span> Determinante e traço de uma matriz</h3>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Definição 2.8</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>O <strong>determinante</strong> de uma matriz <span class="math inline">\(\mathbf{A}\)</span> é o escalar</p>
<p><span class="math display">\[
|\mathbf{A}| = \sum_j (-1)^k a_{1 j_1} a_{2 j_2}, \ldots, a_{n j_n},
\]</span></p>
<p>onde a soma é realizada para todas as <span class="math inline">\(n!\)</span> permutações de grau <span class="math inline">\(n\)</span>, e <span class="math inline">\(k\)</span> é o número de mudanças necessárias para que os segundos subscritos sejam colocados na ordem <span class="math inline">\(1,2, \ldots, n.\)</span></p>
</div>
</div>
<p>Em termos de notação vamos usar <span class="math inline">\(|\mathbf{A}|\)</span> ou <span class="math inline">\(\det{(A)}\)</span>. A Definição 2.8 é difícil de entender e pouco útil para avaliar determinantes de matrizes de grande dimensão. Entretanto, nestes casos temos sempre que recorrer a métodos computacionais. Para matrizes pequenas é fácil obter o determinante. Vamos fazer um exemplo simples com uma matriz <span class="math inline">\(2 \times 2\)</span> apenas como ilustração.</p>
<p>Considere a matriz</p>
<p><span class="math display">\[
\mathbf{A} = \begin{pmatrix}
3 &amp; -2\\
-2 &amp; 4
\end{pmatrix}.
\]</span></p>
<p>Usando a definição precisamos encontrar todas as <span class="math inline">\(n!\)</span> combinações de produtos contendo um elemento de cada linha e coluna. Neste caso <span class="math inline">\(n = 2\)</span> e <span class="math inline">\(n! = 2 \cdot 1 = 2\)</span>. Teremos apenas duas combinações. Na primeira combinação vamos pegar o elemento <span class="math inline">\(a_{11} = 3\)</span> e multiplicar pelo elemento <span class="math inline">\(a_{22} = 4\)</span>. Neste caso os índices de coluna já estão na ordem crescente, então o número de trocas foi <span class="math inline">\(0\)</span>. O segundo termo será o elemento <span class="math inline">\(a_{12} = -2\)</span> multiplicado pelo elemento <span class="math inline">\(a_{21} = -2\)</span>. Neste caso, para que os índices de coluna fiquem em ordem crescente, precisamos fazer uma mudança, então <span class="math inline">\(k = 1\)</span>.</p>
<p><span class="math display">\[
|\mathbf{A}| = (-1)^0 a_{11} a_{22} + (-1)^1 a_{12} a_{21} = 1 \cdot (3 \cdot 4) - (-2 \cdot -2) =  12 - 4 = 8.
\]</span></p>
<p>Em <code>R</code> o determinante de uma matriz pode ser obtido por meio da função <code>determinant()</code>, conforme ilustrado no Código 2.12.</p>
<p><strong>Código 2.12</strong> Determinante de uma matriz.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">4</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">determinant</span>(A, <span class="at">logarithm =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$modulus
[1] 8
attr(,"logarithm")
[1] FALSE

$sign
[1] 1

attr(,"class")
[1] "det"</code></pre>
</div>
</div>
<p>É muito comum precisarmos do logaritmo do determinante, assim a função <code>determinant()</code> traz essa opção como <em>default </em>. Por isso, para obter o determinante de <span class="math inline">\(\mathbf{A}\)</span> precisamos incluir o argumento <code>logarithm = FALSE</code>. Caso contrário o determinante seria obtido em escala logarítmica.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">determinant</span>(A, <span class="at">logarithm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$modulus
[1] 2.079442
attr(,"logarithm")
[1] TRUE

$sign
[1] 1

attr(,"class")
[1] "det"</code></pre>
</div>
</div>
<p>Alguns aspectos interessantes sobre determinantes são:</p>
<ol type="1">
<li>Se <span class="math inline">\(\mathbf{A}\)</span> é singular, <span class="math inline">\(|\mathbf{A}| = 0\)</span>.</li>
<li>Se <span class="math inline">\(\mathbf{A}\)</span> é não singular, <span class="math inline">\(|\mathbf{A}| \neq 0\)</span>.</li>
<li>Se <span class="math inline">\(\mathbf{A}\)</span> é positiva definida, <span class="math inline">\(|\mathbf{A}| &gt; 0\)</span>.</li>
<li><span class="math inline">\(|\mathbf{A}^{\top}| = |\mathbf{A}|\)</span>.</li>
<li>Se <span class="math inline">\(\mathbf{A}\)</span> é não singular, <span class="math inline">\(|\mathbf{A}^{-1}| = \frac{1}{|\mathbf{A}|}\)</span>.</li>
</ol>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Definição 2.9</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>O <strong>traço</strong> de uma matriz <span class="math inline">\(\mathbf{A}\)</span> <span class="math inline">\(n \times n\)</span> é um escalar definido como a soma dos elementos da diagonal, <span class="math inline">\(\mathrm{tr}(\mathbf{A}) = \sum_{i=1}^n a_{ii}\)</span>.</p>
</div>
</div>
<p>Algumas propriedades do traço:</p>
<ol type="1">
<li>Se <span class="math inline">\(\mathbf{A}\)</span> e <span class="math inline">\(\mathbf{B}\)</span> são <span class="math inline">\(n \times n\)</span>, então</li>
</ol>
<p><span class="math display">\[
\mathrm{tr}(\mathbf{A} + \mathbf{B}) = \mathrm{tr}(\mathbf{A}) + \mathrm{tr}(\mathbf{B}).
\]</span></p>
<ol start="2" type="1">
<li>Se <span class="math inline">\(\mathbf{A}\)</span> é <span class="math inline">\(n \times p\)</span> e <span class="math inline">\(\mathbf{B}\)</span> e <span class="math inline">\(p \times n\)</span>, então</li>
</ol>
<p><span class="math display">\[
\mathrm{tr}(\mathbf{AB}) = \mathrm{tr}(\mathbf{BA}).
\]</span></p>
<p>Em <code>R</code> não temos uma função explícita para a obtenção do traço devido a sua simplicidade. Assim, podemos obter o traço simplesmente acessando os elementos da diagonal da matriz com a função <code>diag()</code> e somar com a função <code>sum()</code>, conforme ilustrado no Código 2.13.</p>
<p><strong>Código 2.13</strong> Traço de uma matriz.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">4</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">diag</span>(A))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
</div>
</section>
<section id="cálculo-vetorial-e-matricial" class="level3" data-number="2.2.6">
<h3 data-number="2.2.6" class="anchored" data-anchor-id="cálculo-vetorial-e-matricial"><span class="header-section-number">2.2.6</span> Cálculo vetorial e matricial</h3>
<p>No Capítulo <span class="math inline">\(1\)</span> vimos como obter a derivada de funções com até duas variáveis independentes. Usando as ferramentas de Cálculo vetorial e matricial podemos obter derivadas de funções com um número arbitrário de variáveis independentes. Seja <span class="math inline">\(y = f(\mathbf{x})\)</span> uma função das variáveis <span class="math inline">\(x_1, x_2, \ldots, x_p\)</span> e <span class="math inline">\(\frac{\partial y}{\partial x_1}, \frac{\partial y}{\partial x_2}, \ldots, \frac{\partial y}{\partial x_p}\)</span> as respectivas derivadas parciais. Assim,</p>
<p><span class="math display">\[
\frac{\partial y}{\partial \mathbf{x}} = \begin{pmatrix}
\frac{\partial y}{\partial x_1}\\
\frac{\partial y}{\partial x_2}\\
\vdots\\
\frac{\partial y}{\partial x_p}
\end{pmatrix}.
\]</span></p>
<p>Basicamente, a ideia é derivar em cada uma das variáveis independentes e arranjar as derivadas parciais em um vetor de tamanho adequado. Usando esta ideia simples é possível calcular a derivada de funções mais complicadas. Vejamos algumas derivadas vetoriais e matriciais úteis em ciência de dados.</p>
<p>Sendo <span class="math inline">\(\mathbf{a}^{\top} = (a_1, a_2, \ldots, a_p)\)</span> um vetor de constantes e <span class="math inline">\(\mathbf{A}\)</span> uma matriz simétrica de constantes.</p>
<ol type="1">
<li>Seja <span class="math inline">\(y = \mathbf{a}^{\top} \mathbf{x} = \mathbf{x}^{\top} \mathbf{a}\)</span>. Então,</li>
</ol>
<p><span class="math display">\[
\frac{\partial y}{\partial \mathbf{x}} = \frac{\partial (\mathbf{x}^{\top} \mathbf{a})}{\partial \mathbf{x}} = \mathbf{a}.
\]</span></p>
<ol start="2" type="1">
<li>Seja <span class="math inline">\(y = \mathbf{x}^{\top} \mathbf{A} \mathbf{x}\)</span>. Então,</li>
</ol>
<p><span class="math display">\[
\frac{\partial y}{\partial \mathbf{x}} = \frac{\partial (\mathbf{x}^{\top} \mathbf{A} \mathbf{x}) }{\partial \mathbf{x}} = 2 \mathbf{A} \mathbf{x}.
\]</span></p>
<p>De forma similar, se <span class="math inline">\(y = f(\mathbf{X})\)</span> onde <span class="math inline">\(\mathbf{X}\)</span> é uma matriz <span class="math inline">\(p \times p\)</span>. As derivadas parciais de <span class="math inline">\(y\)</span> em relação a cada <span class="math inline">\(x_{ij}\)</span> são organizadas em uma matriz.</p>
<p><span class="math display">\[
\frac{\partial y}{\partial \mathbf{X}} = \begin{pmatrix}
\frac{\partial y}{\partial x_{11}} &amp; \ldots &amp; \frac{\partial y}{\partial x_{1p}}\\
\vdots &amp; \ddots  &amp; \vdots\\
\frac{\partial y}{\partial x_{p1}} &amp; \ldots &amp; \frac{\partial y}{\partial x_{pp}}
\end{pmatrix}.
\]</span></p>
<p>Algumas derivadas importantes envolvendo matrizes são apresentadas abaixo.</p>
<ol type="1">
<li>Seja <span class="math inline">\(y = \mathrm{tr}(\mathbf{X}\mathbf{A})\)</span> sendo <span class="math inline">\(\mathbf{X}\)</span> <span class="math inline">\(p \times p\)</span> e definida positiva e <span class="math inline">\(\mathbf{A}\)</span> <span class="math inline">\(p \times p\)</span> constantes. Então,</li>
</ol>
<p><span class="math display">\[
\frac{\partial y}{\partial \mathbf{X}} = \frac{\partial \mathrm{tr}(\mathbf{X}\mathbf{A})}{\partial \mathbf{X}} =  \mathbf{A} + \mathbf{A}^{\top} - \mathrm{diag}(\mathbf{A}).
\]</span></p>
<ol start="2" type="1">
<li>Sendo <span class="math inline">\(\mathbf{A}\)</span> não singular com derivadas <span class="math inline">\(\frac{\partial \mathbf{A}}{\partial x}\)</span>. Então,</li>
</ol>
<p><span class="math display">\[
\frac{\partial \mathbf{A}^{-1}}{\partial x} = - \mathbf{A}^{-1} \frac{\partial \mathbf{A}}{\partial x} \mathbf{A}^{-1}.
\]</span></p>
<ol start="3" type="1">
<li>Sendo <span class="math inline">\(\mathbf{A}\)</span> <span class="math inline">\(n \times n\)</span> positiva definida. Então,</li>
</ol>
<p><span class="math display">\[
\frac{\partial \log |\mathbf{A}|}{\partial x} = \mathrm{tr} \left( \mathbf{A}^{-1} \frac{\partial \mathbf{A}}{\partial x} \right).
\]</span></p>
</section>
<section id="regressão-linear-múltipla" class="level3" data-number="2.2.7">
<h3 data-number="2.2.7" class="anchored" data-anchor-id="regressão-linear-múltipla"><span class="header-section-number">2.2.7</span> Regressão linear múltipla</h3>
<p>Na seção 1.2.9 construímos o modelo de regressão linear simples, onde apenas uma covariável <span class="math inline">\(x\)</span> descreve o comportamento da variável dependente <span class="math inline">\(y\)</span>, por meio de uma reta, ou seja,</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_i + \epsilon_i.
\]</span></p>
<p>No modelo de regressão linear múltipla estendemos este modelo para levar em consideração um número arbitrário <span class="math inline">\(p\)</span> de covariáveis <span class="math inline">\(x_{ip}\)</span>. Nesta notação <span class="math inline">\(x_{ip}\)</span> é o valor da <span class="math inline">\(p-\)</span>ésima covariável associada a observação <span class="math inline">\(i\)</span> para <span class="math inline">\(i = 1, \ldots, n\)</span>, sendo <span class="math inline">\(n\)</span> o número de observações. Note que a primeira covariável é assumida como <span class="math inline">\(1\)</span> para representar o intercepto.</p>
<p>O modelo de regressão linear múltipla é então escrito como</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \ldots + \beta_p x_{ip} + \epsilon_i.
\]</span></p>
<p>Podemos escrever o modelo para cada uma das <span class="math inline">\(n\)</span> observações, como segue</p>
<p><span class="math display">\[
\begin{matrix}
y_1 = \beta_0 + \beta_1 x_{11} + \beta_2 x_{12} + \ldots \beta_{p} x_{1p} + \epsilon_1 \\
y_2 = \beta_0 + \beta_1 x_{21} + \beta_2 x_{22} + \ldots \beta_{p} x_{2p} + \epsilon_2\\
\vdots \\
y_n = \beta_0 + \beta_1 x_{n1} + \beta_2 x_{n2} + \ldots \beta_{p} x_{np} + \epsilon_p.\\
\end{matrix}
\]</span></p>
<p>Agora organizamos os termos em formato matricial</p>
<p><span class="math display">\[
\underset{n\times 1}{\begin{bmatrix}
y_1\\
y_2\\
\vdots \\
y_n
\end{bmatrix}} =
\underset{n\times p}{\begin{bmatrix}
1 &amp; x_{11} &amp; \ldots &amp; x_{p1} \\
1 &amp; x_{12} &amp; \ldots &amp; x_{p1} \\
\vdots &amp; \vdots  &amp; \ddots &amp; \vdots \\
1&amp; x_{1n} &amp; \ldots &amp; x_{pn}
\end{bmatrix} }
\underset{p \times 1}{
\begin{bmatrix}
\beta_0 \\
\vdots \\
\beta_p
\end{bmatrix}
} + \underset{n\times 1}{\begin{bmatrix}
\epsilon_1\\
\epsilon_2\\
\vdots \\
\epsilon_n
\end{bmatrix}}
\]</span></p>
<p>Por fim, usamos uma notação mais compacta para representar o modelo</p>
<p><span class="math display">\[
\underset{n \times 1}{\mathbf{y}} = \underset{n \times p }{\mathbf{X}} \underset{p\times 1}{\boldsymbol{\beta}} + \underset{n \times 1}{\mathbf{\epsilon}}.
\]</span></p>
<p>Note como todas as multiplicações envolvidas no modelo são compatíveis respeitando as regras dos produtos de matrizes.</p>
<p>Nosso objetivo é encontrar o vetor <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span>, tal que</p>
<p><span class="math display">\[
SQ(\boldsymbol{\beta}) = (\mathbf{y} - \mathbf{X}\boldsymbol{\beta})^{\top} (\mathbf{y} - \mathbf{X}\boldsymbol{\beta}),
\]</span></p>
<p>seja a menor possível.</p>
<p>Esse processo é o que chamamos de estimação dos parâmetros de regressão ou de treinamento do modelo, a segunda nomenclatura é comum na literatura de aprendizado de máquina. Note que novamente temos um processo de minimização, porém agora de uma função com muitas variáveis independentes. Usando as ferramentas de Álgebra Linear podemos facilmente proceder com esse problema de minimização.</p>
<p>O primeiro passo é derivar a soma de quadrados em <span class="math inline">\(\boldsymbol{\beta}\)</span>, usando Cálculo vetorial (ver Seção 2.2.6).</p>
<p>Derivando em <span class="math inline">\(\boldsymbol{\beta}\)</span>, temos</p>
<p><span class="math display">\[
\begin{eqnarray*}
\frac{\partial SQ(\boldsymbol{\beta})}{\partial \boldsymbol{\beta}} &amp;=&amp; \frac{\partial}{\partial \boldsymbol{\beta}} (\mathbf{y} - \mathbf{X}\boldsymbol{\beta})^{\top} (\mathbf{y} - \mathbf{X}\boldsymbol{\beta}) \\
&amp;=&amp; \frac{\partial}{\partial \boldsymbol{\beta}} \left ( (\mathbf{y} - \mathbf{X}\boldsymbol{\beta})^{\top}  \right ) (\mathbf{y} - \mathbf{X}\boldsymbol{\beta}) + (\mathbf{y} - \mathbf{X}\boldsymbol{\beta})^{\top} \frac{\partial}{\partial \boldsymbol{\beta}}  (\mathbf{y} - \mathbf{X}\boldsymbol{\beta}) \\
&amp;=&amp; -\mathbf{X}^{\top}(\mathbf{y} - \mathbf{X}\boldsymbol{\beta}) + (\mathbf{y} - \mathbf{X}\boldsymbol{\beta})^{\top} (-\mathbf{X}) \\
&amp;=&amp; -2\mathbf{X}^{\top}(\mathbf{y} - \mathbf{X}\boldsymbol{\beta}).
\end{eqnarray*}
\]</span></p>
<p>O segundo passo é resolver o sistema de equações lineares resultantes</p>
<p><span class="math display">\[
\begin{eqnarray}
\mathbf{X}^{\top}(\mathbf{y} - \mathbf{X}\boldsymbol{\hat{\beta}}) &amp;=&amp; \boldsymbol{0} \\
\mathbf{X}^{\top}\mathbf{y} - \mathbf{X}^{\top}\mathbf{X}\boldsymbol{\hat{\beta}} &amp;=&amp; 0 \\
\mathbf{X}^{\top}\mathbf{X}\boldsymbol{\hat{\beta}} &amp;=&amp; \mathbf{X}^{\top}\mathbf{y} \tag{2.2} \\
\boldsymbol{\hat{\beta}} &amp;=&amp; (\mathbf{X}^{\top}\mathbf{X})^{-1}\mathbf{X}^{\top}\mathbf{y}. \tag{2.3}
\end{eqnarray}
\]</span></p>
<p>Note que a Equação (2.2) foi multiplicada em ambos os lados por <span class="math inline">\((\mathbf{X}^{\top}\mathbf{X})^{-1}\)</span> para encontrar (2.3). Essa operação corresponde a resolver o sistema de equações lineares. Nós vimos na Seção 2.2.3 como obter a inversa de uma matriz usando o <code>R</code>. Assim, estamos aptos a implementar tais operações em <code>R</code>.</p>
<p>Para exemplificar a implementação do modelo de regressão linear múltipla, vamos usar um conjunto de dados muito famoso sobre o preço de imóveis na cidade de Boston. O conjunto de dados está disponível no pacote <code>MASS</code> e contém além da variável resposta <span class="math inline">\(13\)</span> covariáveis e <span class="math inline">\(506\)</span> observações. As primeiras seis observações do conjunto de dados são apresentadas abaixo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(MASS)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Boston)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Boston)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     crim zn indus chas   nox    rm  age    dis rad tax ptratio  black lstat
1 0.00632 18  2.31    0 0.538 6.575 65.2 4.0900   1 296    15.3 396.90  4.98
2 0.02731  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8 396.90  9.14
3 0.02729  0  7.07    0 0.469 7.185 61.1 4.9671   2 242    17.8 392.83  4.03
4 0.03237  0  2.18    0 0.458 6.998 45.8 6.0622   3 222    18.7 394.63  2.94
5 0.06905  0  2.18    0 0.458 7.147 54.2 6.0622   3 222    18.7 396.90  5.33
6 0.02985  0  2.18    0 0.458 6.430 58.7 6.0622   3 222    18.7 394.12  5.21
  medv
1 24.0
2 21.6
3 34.7
4 33.4
5 36.2
6 28.7</code></pre>
</div>
</div>
<p>As covariáveis disponíveis são</p>
<ul>
<li>crim: taxa de crimes per capita.</li>
<li>zn: proporção de terrenos residenciais zoneados para lotes com mais de 25.000 pés quadrados.</li>
<li>indus: proporção de acres de negócios não varejistas por cidade.</li>
<li>chas: variável dummy de Charles River (1 se a área limita o rio; 0 caso contrário).</li>
<li>nox: concentração de óxido de nitrogênio (parte por 10 milhões).</li>
<li>rm: número médio de quartos por habitação.</li>
<li>age: proporção de unidades ocupadas pelo proprietário construídas antes de 1940.</li>
<li>dis: média ponderada das distâncias a cinco centros de empregos de Boston.</li>
<li>rad: índice de acessibilidade às rodovias radiais.</li>
<li>tax: taxa de imposto sobre a propriedade de valor total por $10.000.</li>
<li>ptratio: proporção aluno-professor por cidade.</li>
<li>black: <span class="math inline">\(1000 (Bk - 0,63)^2\)</span> onde <span class="math inline">\(Bk\)</span> é a proporção de negros por cidade.</li>
<li>lstat: Porcentagem da população em pobreza.</li>
</ul>
<p>A variável resposta é o valor mediano das casas ocupadas pelos proprietários em <span class="math inline">\(\$1000\)</span>, codificada como <code>medv</code>. O primeiro passo para implementar o modelo de regressão linear múltipla para este problema é montar a matriz <span class="math inline">\(\mathbf{X}\)</span>, também chamada de matriz de delineamento. Ela vai conter os valores de todas as covariáveis de interesse. Em <code>R</code> podemos usar a função <code>model.matrix()</code> para construir tal matriz. Para este exemplo, vamos usar apenas as primeiras cinco covariáveis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> crim <span class="sc">+</span> zn <span class="sc">+</span> indus <span class="sc">+</span> chas <span class="sc">+</span> nox, <span class="at">data =</span> Boston)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)    crim zn indus chas   nox
1           1 0.00632 18  2.31    0 0.538
2           1 0.02731  0  7.07    0 0.469
3           1 0.02729  0  7.07    0 0.469
4           1 0.03237  0  2.18    0 0.458
5           1 0.06905  0  2.18    0 0.458
6           1 0.02985  0  2.18    0 0.458</code></pre>
</div>
</div>
<p>Note que a função <code>model.matrix()</code> automaticamente inclui uma coluna de <span class="math inline">\(1\)</span>’s para representar o intercepto. O vetor <span class="math inline">\(y\)</span> neste caso é a coluna <code>medv</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Boston<span class="sc">$</span>medv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Por fim, implementamos a Equação (2.3) de duas formas distintas. Convido o leitor a tentar entender qual a diferença computacional entre elas. Tal diferença ficará clara quando discutirmos algoritmos para a solução de sistemas de equações lineares e obtenção da matriz inversa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forma ingênua</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)<span class="sc">%*%</span><span class="fu">t</span>(X)<span class="sc">%*%</span>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   [,1]
(Intercept) 29.48994059
crim        -0.21851904
zn           0.05511047
indus       -0.38348055
chas         7.02622266
nox         -5.42465902</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forma eficiente</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X, <span class="fu">t</span>(X)<span class="sc">%*%</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   [,1]
(Intercept) 29.48994059
crim        -0.21851904
zn           0.05511047
indus       -0.38348055
chas         7.02622266
nox         -5.42465902</code></pre>
</div>
</div>
<p>Podemos usar a função <code>lm()</code> para conferir a nossa implementação.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> zn <span class="sc">+</span> indus <span class="sc">+</span> chas <span class="sc">+</span> nox, <span class="at">data =</span> Boston))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        crim          zn       indus        chas         nox 
29.48994059 -0.21851904  0.05511047 -0.38348055  7.02622266 -5.42465902 </code></pre>
</div>
</div>
<p>Os resultados são idênticos. Podemos usar o modelo para predizer o valor de um imóvel dado os valores de suas covariáveis. Basicamente, tudo o que foi discutido no caso do modelo de regressão linear simples se adapta naturalmente para o modelo de regressão linear múltipla.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../content/Modulo01/index.html" class="pagination-link  aria-label=" &lt;span="" diferencial="" e="" integral&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Cálculo Diferencial e Integral</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../content/Modulo03/index.html" class="pagination-link" aria-label="<span class='chapter-number'>3</span>&nbsp; <span class='chapter-title'>Estatística Não Paramétrica 2</span>">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Estatística Não Paramétrica 2</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Estatística 2023-2026</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://raymz1990.github.io/CE313/edit/main/book/content/Modulo02/index.qmd" class="toc-action"><i class="bi bi-git"></i>Edit this page</a></li><li><a href="https://raymz1990.github.io/CE313/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>